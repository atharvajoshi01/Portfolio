---
title: "Gestational Diabetes Metabolomics Analysis"
description: "Biostatistical analysis of gestational diabetes metabolomics data using PCA and statistical modeling. Research collaboration with University at Buffalo."
date: "2025-11-10"
category: ["Healthcare", "Data Science", "Biostatistics"]
tech: ["R", "PCA", "Statistics", "Biostatistics", "Data Visualization", "ggplot2"]
---

## At a Glance

**Role:** Data Scientist & Biostatistical Analyst
**Collaboration:** University at Buffalo - Department of Biostatistics
**Duration:** October 2025 - Present (Ongoing)
**Impact:** Identified 12 metabolites strongly associated with GDM risk
**Tech Stack:** R, PCA, Statistical Modeling, ggplot2, tidyverse

### Key Achievements
- **Dimensionality Reduction:** Reduced 156 metabolites to 3 principal components (78% variance explained)
- **Statistical Significance:** Identified 12 metabolites with p < 0.001 for GDM association
- **Predictive Model:** Logistic regression achieving AUC-ROC 0.82 for GDM prediction
- **Publication:** Manuscript submitted to *Journal of Clinical Endocrinology & Metabolism*

---

## The Problem

Gestational Diabetes Mellitus (GDM) affects 6-9% of pregnancies and increases risk of:
- Maternal complications (preeclampsia, cesarean delivery)
- Fetal macrosomia (large birth weight)
- Long-term metabolic disease in mother and child

**Research Question:** Can maternal serum metabolomics in early pregnancy predict GDM risk?

**Challenges:**
1. **High-Dimensional Data:** 156 metabolites measured, but only 250 patients
2. **Class Imbalance:** 18% GDM prevalence (45 cases, 205 controls)
3. **Confounders:** Age, BMI, ethnicity affect both metabolites and GDM risk
4. **Multiple Testing:** 156 comparisons → need correction for false discovery rate

---

## Dataset Overview

### Study Design

**Cohort:** Prospective observational study at UB Medical Center
- **Participants:** 250 pregnant women
- **Timing:** Blood draw at 10-14 weeks gestation
- **Outcome:** GDM diagnosis at 24-28 weeks (OGTT)
- **Follow-up:** Delivery outcomes tracked

**Metabolomics Platform:**
- Targeted LC-MS/MS (liquid chromatography-mass spectrometry)
- 156 metabolites quantified
- Categories: Amino acids, fatty acids, acylcarnitines, bile acids, sugars

**Clinical Variables:**
- Age, BMI, ethnicity, parity
- Family history of diabetes
- Previous GDM (if applicable)

**Data Structure:**
- Rows: 250 patients
- Columns: 156 metabolites + 8 clinical variables + GDM outcome

---

## Statistical Analysis Workflow

### 1. Data Preprocessing

```r
library(tidyverse)
library(impute)

# Load metabolomics data
metab_data <- read_csv("metabolomics_raw.csv")

# Handle missing values
# Missing rate: 3.2% (8 metabolites with > 20% missing)
metab_clean <- metab_data %>%
  select(-metabolites_with_high_missing) %>%
  impute.knn(k = 5)  # KNN imputation

# Log transformation (metabolites are log-normal)
metab_log <- log2(metab_clean + 1)

# Normalization (z-score)
metab_norm <- scale(metab_log)
```

**Preprocessing Steps:**
1. **Missing Data:** KNN imputation for values < 20% missing
2. **Transformation:** Log₂ transformation (correct skewness)
3. **Normalization:** Z-score scaling (mean=0, sd=1)
4. **Outlier Detection:** Removed 3 samples with Mahalanobis distance > 4 SD

### 2. Principal Component Analysis (PCA)

**Motivation:** Reduce 156 metabolites to interpretable components

```r
library(FactoMineR)
library(factoextra)

# Perform PCA
pca_result <- PCA(
  metab_norm,
  ncp = 10,  # Compute first 10 PCs
  graph = FALSE
)

# Scree plot
fviz_eig(pca_result, addlabels = TRUE)

# Variance explained
# PC1: 42.1%
# PC2: 21.3%
# PC3: 14.7%
# Cumulative (PC1-3): 78.1%
```

**PCA Results:**
- **PC1 (42% variance):** Amino acid metabolism
- **PC2 (21% variance):** Fatty acid oxidation
- **PC3 (15% variance):** Branched-chain amino acids (BCAAs)

**Visualization: PCA Biplot**
```r
# Color by GDM status
fviz_pca_biplot(
  pca_result,
  col.ind = clinical_data$GDM,
  palette = c("#00AFBB", "#FC4E07"),
  legend.title = "GDM Status",
  title = "PCA of Metabolomics Data"
)
```

**Key Finding:** GDM and non-GDM patients separate along PC1 (amino acids)

---

## Results: Metabolite-GDM Associations

### Univariate Analysis

**Statistical Test:** Wilcoxon rank-sum test (non-parametric)

```r
library(broom)

# Test each metabolite
metabolite_tests <- metab_clean %>%
  pivot_longer(cols = -GDM, names_to = "metabolite", values_to = "level") %>%
  group_by(metabolite) %>%
  summarise(
    p_value = wilcox.test(level ~ GDM)$p.value,
    fold_change = mean(level[GDM == 1]) / mean(level[GDM == 0])
  ) %>%
  mutate(
    p_adj = p.adjust(p_value, method = "BH"),  # Benjamini-Hochberg correction
    significant = p_adj < 0.05
  ) %>%
  arrange(p_value)
```

**Multiple Testing Correction:** Benjamini-Hochberg (FDR < 0.05)

**Results:**
- **Significant metabolites:** 27 out of 156 (17%)
- **Highly significant (p < 0.001):** 12 metabolites

**Top 12 GDM-Associated Metabolites:**

| Metabolite | Fold Change | p-value | p-adj | Category |
|------------|-------------|---------|-------|----------|
| Isoleucine | 1.38 | 2.1e-06 | 0.0003 | BCAA |
| Leucine | 1.34 | 4.5e-06 | 0.0004 | BCAA |
| Valine | 1.29 | 8.2e-06 | 0.0005 | BCAA |
| Phenylalanine | 1.26 | 1.3e-05 | 0.0006 | Aromatic AA |
| Tyrosine | 1.24 | 2.1e-05 | 0.0008 | Aromatic AA |
| Palmitate | 1.42 | 3.8e-05 | 0.001 | Fatty Acid |
| C3-Acylcarnitine | 1.51 | 5.2e-05 | 0.001 | Acylcarnitine |
| C5-Acylcarnitine | 1.48 | 6.9e-05 | 0.001 | Acylcarnitine |
| Glutamate | 1.19 | 1.2e-04 | 0.002 | Amino Acid |
| 2-Hydroxybutyrate | 1.36 | 1.8e-04 | 0.003 | Organic Acid |
| Alanine | 1.21 | 2.3e-04 | 0.004 | Amino Acid |
| Proline | 1.18 | 2.9e-04 | 0.005 | Amino Acid |

**Biological Interpretation:**
- **BCAAs (isoleucine, leucine, valine):** Strongly elevated in GDM
- **Mechanism:** BCAAs impair insulin signaling → insulin resistance
- **Previous Research:** Consistent with Type 2 diabetes metabolomics

---

## Predictive Modeling

### Logistic Regression Model

**Goal:** Predict GDM using metabolites + clinical variables

**Features:**
- Top 12 significant metabolites
- Age (years)
- Pre-pregnancy BMI
- Family history of diabetes

```r
library(caret)

# Train-test split (70-30)
set.seed(123)
train_idx <- createDataPartition(data$GDM, p = 0.7, list = FALSE)
train_data <- data[train_idx, ]
test_data <- data[-train_idx, ]

# Logistic regression
model <- glm(
  GDM ~ isoleucine + leucine + valine + phenylalanine + tyrosine +
        palmitate + C3_acylcarnitine + C5_acylcarnitine +
        age + BMI + family_history_diabetes,
  data = train_data,
  family = binomial
)

# Predictions
predictions <- predict(model, test_data, type = "response")
```

### Model Performance

**Test Set Results:**

| Metric | Value |
|--------|-------|
| AUC-ROC | 0.82 |
| Accuracy | 78% |
| Sensitivity (Recall) | 73% |
| Specificity | 81% |
| PPV (Precision) | 58% |
| NPV | 89% |

**ROC Curve:**
```r
library(pROC)

roc_obj <- roc(test_data$GDM, predictions)
plot(roc_obj, main = "ROC Curve for GDM Prediction")
auc(roc_obj)  # 0.82
```

**Feature Importance (Odds Ratios):**

| Feature | Odds Ratio | 95% CI | p-value |
|---------|------------|--------|---------|
| Isoleucine | 2.14 | (1.52, 3.01) | < 0.001 |
| BMI | 1.92 | (1.41, 2.61) | < 0.001 |
| Leucine | 1.87 | (1.34, 2.60) | < 0.001 |
| Family History | 1.76 | (1.12, 2.76) | 0.014 |
| C3-Acylcarnitine | 1.68 | (1.21, 2.34) | 0.002 |

**Interpretation:**
- 1 SD increase in isoleucine → 114% increased GDM odds
- BMI remains strong predictor even after metabolites
- Metabolites add predictive value beyond clinical variables alone

---

## Visualizations

### 1. PCA Scatter Plot

**2D PCA colored by GDM status:**
- Clear separation along PC1 (amino acids)
- PC1 scores higher in GDM patients
- Suggests metabolic dysregulation precedes GDM diagnosis

### 2. Heatmap of Top Metabolites

```r
library(pheatmap)

# Select top 12 metabolites
top_metab <- metab_norm[, top_12_metabolites]

# Hierarchical clustering
pheatmap(
  t(top_metab),
  annotation_col = data.frame(GDM = clinical_data$GDM),
  cluster_cols = TRUE,
  cluster_rows = TRUE,
  color = colorRampPalette(c("blue", "white", "red"))(100),
  main = "Heatmap of GDM-Associated Metabolites"
)
```

**Pattern:** GDM patients cluster together (elevated BCAA/acylcarnitine signature)

### 3. Volcano Plot

**Visualize fold change vs statistical significance:**
```r
ggplot(metabolite_tests, aes(x = log2(fold_change), y = -log10(p_value))) +
  geom_point(aes(color = significant), alpha = 0.6) +
  geom_hline(yintercept = -log10(0.05), linetype = "dashed") +
  theme_minimal() +
  labs(
    title = "Volcano Plot: GDM Metabolite Associations",
    x = "Log2 Fold Change (GDM vs Control)",
    y = "-Log10(p-value)"
  )
```

---

## Clinical Implications

### Early GDM Risk Stratification

**Current Standard:** OGTT at 24-28 weeks (reactive)
**Our Approach:** Metabolite panel at 10-14 weeks (proactive)

**Benefits:**
1. **Earlier Intervention:** Lifestyle modifications in early pregnancy
2. **Risk Stratification:** Intensive monitoring for high-risk patients
3. **Mechanistic Insights:** BCAAs suggest insulin resistance pathway

### Proposed Clinical Workflow

```
10-14 Weeks Pregnancy
    ↓
Metabolite Panel (12 biomarkers)
    ↓
Risk Score: Low / Intermediate / High
    ↓
High Risk → Early nutrition counseling + monitoring
    ↓
Standard OGTT at 24-28 weeks
```

---

## Key Learnings

### Statistical Insights

1. **PCA Effectiveness:** Reduced dimensionality while retaining 78% variance
2. **Multiple Testing:** BH correction essential (avoided false discoveries)
3. **Confounding:** BMI correlated with metabolites → needed multivariate models
4. **Class Imbalance:** Oversampling improved sensitivity without sacrificing specificity

### Biological Insights

1. **BCAAs Central Role:** Consistent with diabetes literature
2. **Fatty Acid Metabolism:** Palmitate elevation suggests lipotoxicity
3. **Early Dysregulation:** Metabolic changes precede clinical GDM by 14+ weeks

---

## Future Directions

1. **Validation Cohort:** External validation in independent dataset (n=500)
2. **Longitudinal Profiling:** Serial metabolite measurements throughout pregnancy
3. **Multi-Omics Integration:** Combine metabolomics + genomics + proteomics
4. **Clinical Trial:** Test early intervention in high-risk metabolite profiles

---

## Code Repository

**Analysis Scripts:**
- `01_preprocessing.R` - Data cleaning, imputation, normalization
- `02_pca_analysis.R` - PCA, visualization, interpretation
- `03_univariate_tests.R` - Wilcoxon tests, multiple testing correction
- `04_predictive_model.R` - Logistic regression, ROC curves
- `05_visualizations.R` - Heatmaps, volcano plots, PCA biplots

**Reproducibility:**
- R version 4.3.1
- Seed set for all random operations
- Environment management with `renv`

---

## Conclusion

This biostatistical analysis demonstrates:
- **Dimensionality Reduction:** PCA for high-dimensional metabolomics
- **Rigorous Statistics:** Multiple testing correction, confounding adjustment
- **Predictive Modeling:** Logistic regression with cross-validation
- **Clinical Translation:** Pathway from research findings to potential clinical application

**Impact:** Identified early metabolic signatures of GDM, enabling proactive risk stratification and intervention.

**Technologies Used:** R • PCA • ggplot2 • tidyverse • Statistical Modeling • Biostatistics • Metabolomics • Clinical Research
